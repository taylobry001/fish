<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé£ FISHING GACHA ¬∑ RODS ¬∑ BOSS CHOICE ¬∑ KEYBIND L</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #0a1a2a;
            color: white;
            min-height: 100vh;
            padding: 12px;
            transition: background 1s ease;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 18px;
        }
        @media (max-width: 1200px) { .container { grid-template-columns: 1fr; } }
        
        .header {
            grid-column: 1/-1;
            background: rgba(0,20,40,0.8);
            backdrop-filter: blur(12px);
            border-radius: 40px;
            padding: 16px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #4faaff;
        }
        h1 { font-size: 2rem; background: linear-gradient(135deg, #aaf0ff, #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .coin-display { background: #0b2a3b; padding: 10px 28px; border-radius: 60px; font-size: 1.8rem; border: 2px solid #ffd966; box-shadow: 0 0 20px gold; }

        .fishing-area {
            background: rgba(0,20,30,0.6);
            backdrop-filter: blur(10px);
            border-radius: 48px;
            padding: 24px;
            border: 2px solid #7fc9ff;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .fish-button {
            width: 220px; height: 220px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #6ec8ff, #01497c);
            border: 8px solid #b5e6ff;
            box-shadow: 0 20px 40px black, 0 0 80px #4fc3f7;
            display: flex; align-items: center; justify-content: center;
            font-size: 100px; cursor: pointer; transition: 0.2s;
            margin: 20px 0 30px;
        }
        .fish-button:active { transform: scale(0.92); box-shadow: 0 0 50px cyan; }

        /* boss encounter modal */
        .boss-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            display: none; align-items: center; justify-content: center;
            z-index: 2000;
        }
        .boss-card {
            background: #1a2f3a; border: 4px solid #f05454; border-radius: 60px;
            padding: 40px; text-align: center; max-width: 500px;
            animation: bossPulse 1.5s infinite alternate;
        }
        @keyframes bossPulse { from { box-shadow: 0 0 30px red; } to { box-shadow: 0 0 80px orange; } }
        .boss-emoji { font-size: 120px; }
        .boss-buttons { display: flex; gap: 20px; justify-content: center; margin-top: 30px; }

        /* crate spin animation */
        .crate-spin {
            animation: spin 0.8s cubic-bezier(0.2, 0.9, 0.3, 1.3);
        }
        @keyframes spin {
            0% { transform: rotate(0deg) scale(0.2); opacity: 0; }
            50% { transform: rotate(180deg) scale(1.2); opacity: 0.8; }
            100% { transform: rotate(360deg) scale(1); opacity: 1; }
        }

        .panel {
            background: rgba(3, 18, 30, 0.9);
            backdrop-filter: blur(8px);
            border-radius: 28px;
            padding: 20px 16px;
            border: 2px solid #2a6f8d;
            margin-bottom: 18px;
            max-height: 450px;
            overflow-y: auto;
        }
        .panel h3 { color: #9fd9ff; border-bottom: 2px dashed #2c7da0; padding-bottom: 8px; margin-bottom: 16px; }

        .rod-item {
            background: #113946; border-radius: 20px; padding: 12px;
            margin: 8px 0; display: flex; align-items: center; gap: 15px;
            border: 2px solid transparent; cursor: pointer;
        }
        .rod-item.equipped { border-color: gold; background: #1b4f5e; }
        .rod-item:hover { background: #1b5169; }

        .bait-item {
            background: #113946; border-radius: 20px; padding: 12px;
            display: flex; align-items: center; gap: 15px; border: 1px solid #47b5ff;
            cursor: pointer; transition: 0.2s;
        }
        .bait-item:hover { background: #1b5169; border-color: gold; }

        .btn {
            background: #1d4155; border: 2px solid #71c5ff; border-radius: 50px;
            padding: 16px 12px; font-weight: 700; color: white; cursor: pointer;
            transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-danger { background: #b71c1c; border-color: #ff8a80; }

        .boss-chance-indicator {
            position: fixed; bottom: 20px; left: 20px;
            background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 40px;
            border: 2px solid #ffaa00; font-weight: bold; z-index: 100;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üé£ ROD EQUIP ¬∑ BOSS CHOICE ¬∑ 'L' TO FISH</h1>
        <div class="coin-display"><span>ü™ô</span><span id="coins">10,000</span></div>
    </div>

    <!-- left sidebar -->
    <div class="left-sidebar">
        <div class="panel">
            <h3>üìä STATS</h3>
            <div>üî• Pity: <span id="pity">0</span></div>
            <div>üåç Zone: <span id="zone">Shallows</span></div>
            <div>üé£ Rod: <span id="rod">Starter Rod</span></div>
            <div>üìä Total: <span id="totalFish">0</span></div>
        </div>
        <div class="panel">
            <h3>üé£ ROD COLLECTION</h3>
            <div id="rodList"></div>
        </div>
        <div class="panel">
            <h3>‚ö° ACTIVE BAITS</h3>
            <div id="activeBaits">none</div>
        </div>
    </div>

    <!-- main area -->
    <div class="fishing-area">
        <div class="fish-button" onclick="catchFish()" id="fishButton">üé£</div>
        <div class="fish-catch-display" id="catchDisplay">
            <div class="caught-fish-emoji">üé£</div>
            <div>Ready to fish! (Press L)</div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; width:100%; margin-top:20px;">
            <button class="btn" onclick="nextZone()">üåç NEXT ZONE</button>
            <button class="btn" onclick="openCrate()">üì¶ CRATE (500ü™ô)</button>
        </div>
    </div>

    <!-- right sidebar -->
    <div class="right-sidebar">
        <div class="panel">
            <h3>üõí BAIT SHOP</h3>
            <div class="bait-grid" id="baitShop"></div>
        </div>
        <div class="panel">
            <h3>üèÜ FISHDEX</h3>
            <div id="fishdexSummary">Catch fish to fill dex!</div>
        </div>
    </div>
</div>

<!-- boss encounter modal -->
<div id="bossEncounter" class="boss-modal">
    <div class="boss-card">
        <div class="boss-emoji" id="bossEmoji">üëæ</div>
        <h2 id="bossName">ABYSSAL LORD</h2>
        <p id="bossDesc">A mighty beast appears! Do you wish to fight?</p>
        <div class="boss-buttons">
            <button class="btn btn-danger" onclick="acceptBoss()">‚öîÔ∏è FIGHT</button>
            <button class="btn" onclick="declineBoss()">üåä FLEE</button>
        </div>
    </div>
</div>

<!-- boss fight bar (visible only during active fight) -->
<div id="bossFightBar" style="display: none; position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); width: 400px; background: #222; border-radius: 40px; border: 3px solid #f05454; padding: 10px; z-index: 150;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <span id="bossFightName">Cthulhu</span>
        <span id="bossHpDisplay">100%</span>
    </div>
    <div style="width:100%; height:30px; background:#111; border-radius:20px; overflow:hidden;">
        <div id="bossHealthBar" style="height:100%; width:100%; background: linear-gradient(90deg, #e43f3f, #ffa726); transition: width 0.3s;"></div>
    </div>
    <button class="btn" onclick="attackBoss()" style="margin-top:10px; width:100%;">‚öîÔ∏è ATTACK</button>
</div>

<!-- boss spawn chance indicator (bottom left) -->
<div class="boss-chance-indicator" id="bossChanceDisplay">‚ö° Boss: 1.00%</div>

<script>
(function() {
    // ==================== MODULAR CONFIG ====================
    const CONFIG = {
        rarities: [
            { id: 'common',    name: 'Common',     emoji: 'üêü', color: '#b0bec5', weight: 400, baseValue: 5 },
            { id: 'uncommon',  name: 'Uncommon',   emoji: 'üê†', color: '#4caf50', weight: 250, baseValue: 15 },
            { id: 'rare',      name: 'Rare',       emoji: 'üê°', color: '#2196f3', weight: 150, baseValue: 45 },
            { id: 'epic',      name: 'Epic',       emoji: 'ü¶à', color: '#9c27b0', weight: 80,  baseValue: 120 },
            { id: 'legendary', name: 'Legendary',  emoji: 'üêã', color: '#ff9800', weight: 40,  baseValue: 350 },
            { id: 'mythic',    name: 'Mythic',     emoji: 'üê≤', color: '#ff3333', weight: 8,   baseValue: 1200 },
            { id: 'divine',    name: 'Divine',     emoji: 'üëë', color: 'gold',     weight: 2,   baseValue: 5000 }
        ],
        zones: [
            { id: 0, name: 'üåä Shallows',       color1: '#4fc3f7', color2: '#01579b' },
            { id: 1, name: 'ü™∏ Coral Reef',      color1: '#00cc99', color2: '#006644' },
            { id: 2, name: 'üåë Deep Sea',        color1: '#001f3f', color2: '#030b17' },
            { id: 3, name: 'üåã Volcanic Vent',   color1: '#ff5722', color2: '#8b0000' },
            { id: 4, name: '‚ùÑÔ∏è Iceberg Lagoon',  color1: '#b3f0ff', color2: '#005073' }
        ],
        // Fodder items for crates (low value)
        crateFodder: [
            'Old Boot', 'Tin Can', 'Rusty Hook', 'Seaweed', 'Broken Reel', 
            'Plastic Bottle', 'Old Tire', 'Soggy Newspaper', 'Lost Sock', 'Broken Oar'
        ],
        bosses: [
            { name: 'Tidal Titan', emoji: 'üåä', hp: 600, reward: 1200 },
            { name: 'Coral Goliath', emoji: 'ü™∏', hp: 850, reward: 2200 },
            { name: 'Abyss Overlord', emoji: 'üëæ', hp: 1300, reward: 4000 },
            { name: 'Cthulhu', emoji: 'üêô', hp: 5000, reward: 30000 }
        ],
        baits: [
            { id: 'common_bait', name: 'Basic Bait', emoji: 'üçû', price: 50, effect: { common: 1.5 }, duration: 10, desc: '+50% common' },
            { id: 'rare_bait', name: 'Rare Bait', emoji: 'ü¶ê', price: 200, effect: { rare: 2.2, epic: 1.4 }, duration: 12, desc: 'rare/epic up' },
            { id: 'epic_bait', name: 'Epic Bait', emoji: 'üç§', price: 550, effect: { epic: 2.8, legendary: 1.9 }, duration: 8, desc: 'epic++' },
            { id: 'legendary_bait', name: 'Legendary Lure', emoji: 'üåü', price: 1800, effect: { legendary: 3.5, mythic: 1.8 }, duration: 5, desc: 'leg/mythic up' }
        ],
        rods: [
            { id: 'starter', name: 'Starter Rod', multiplier: 1.0, rarity: 'common' },
            { id: 'carbon', name: 'Carbon Rod', multiplier: 1.3, rarity: 'uncommon', price: 800 },
            { id: 'composite', name: 'Composite Rod', multiplier: 1.8, rarity: 'rare', price: 2500 },
            { id: 'titanium', name: 'Titanium Rod', multiplier: 2.5, rarity: 'epic', price: 7000 },
            { id: 'void', name: 'Void Rod', multiplier: 4.0, rarity: 'legendary', price: 20000 },
            { id: 'eldritch', name: 'Eldritch Rod', multiplier: 7.0, rarity: 'mythic', crateOnly: true },
            { id: 'divine', name: 'Divine Rod', multiplier: 12.0, rarity: 'divine', crateOnly: true }
        ]
    };

    // Fish database (simplified but counts as many)
    let fishDB = [];
    function buildFishDB() {
        const fishNames = {
            common: ['Carp','Bluegill','Catfish','Bass','Perch','Sunfish','Minnow','Goldfish','Koi','Guppy'],
            uncommon: ['Trout','Puffer','Clownfish','Seahorse','Angelfish','Triggerfish','Parrotfish','Tang'],
            rare: ['Lionfish','Eel','Manta Ray','Moray','Octopus','Cuttlefish','Lobster','Crab'],
            epic: ['Shark','Squid','Whale Shark','Dragonfish','Oarfish','Hammerhead','Mako','Sturgeon'],
            legendary: ['Kraken','Leviathan','Phoenix','Dragon Turtle','Megalodon','Sea Serpent'],
            mythic: ['Time Koi','Void Squid','Abyss Walker','Cthulhu Spawn','Dagon'],
            divine: ['Cthulhu','Azathoth','Yog-Sothoth','Nyarlathotep']
        };
        for (let rarity in fishNames) {
            fishNames[rarity].forEach((name, i) => {
                let zones = [i % CONFIG.zones.length]; // spread across zones
                fishDB.push({ name, emoji: CONFIG.rarities.find(r=>r.id===rarity).emoji, zones, flavor: '...', rarity });
            });
        }
    }
    buildFishDB();

    // ========== GAME STATE ==========
    let gameState = {
        coins: 10000,
        zone: 0,
        rod: 'starter',
        totalCatches: 0,
        pity: 0,
        fishDex: {},
        activeBaits: [],
        ownedRods: ['starter'],
        pendingBoss: null, // boss waiting for player choice
        currentBoss: null,  // boss being fought
        bossHP: 0
    };

    // ========== ROD EQUIPPING ==========
    function equipRod(rodId) {
        if (gameState.ownedRods.includes(rodId)) {
            gameState.rod = rodId;
            updateUI();
            saveGame();
        }
    }

    // ========== UI UPDATES ==========
    function updateUI() {
        document.getElementById('coins').innerText = gameState.coins.toLocaleString();
        document.getElementById('pity').innerText = gameState.pity;
        document.getElementById('zone').innerText = CONFIG.zones[gameState.zone].name;
        let rod = CONFIG.rods.find(r => r.id === gameState.rod);
        document.getElementById('rod').innerText = rod ? rod.name : 'Starter Rod';
        document.getElementById('totalFish').innerText = gameState.totalCatches;

        // boss chance indicator (bottom left)
        let bossChance = (0.01 + gameState.pity * 0.0005) * 100;
        document.getElementById('bossChanceDisplay').innerHTML = `‚ö° Boss: ${bossChance.toFixed(2)}%`;

        // background
        let z = CONFIG.zones[gameState.zone];
        document.body.style.background = `linear-gradient(135deg, ${z.color1}, ${z.color2})`;

        renderRodList();
        renderBaitShop();
        updateActiveBaits();

        // boss fight bar
        if (gameState.currentBoss) {
            document.getElementById('bossFightBar').style.display = 'block';
            document.getElementById('bossFightName').innerText = gameState.currentBoss.name;
            let perc = (gameState.bossHP / gameState.currentBoss.hp) * 100;
            document.getElementById('bossHealthBar').style.width = perc + '%';
            document.getElementById('bossHpDisplay').innerText = Math.round(perc) + '%';
        } else {
            document.getElementById('bossFightBar').style.display = 'none';
        }
    }

    function renderRodList() {
        let div = document.getElementById('rodList');
        let html = '';
        CONFIG.rods.forEach(rod => {
            if (!gameState.ownedRods.includes(rod.id)) return;
            let equipped = (gameState.rod === rod.id) ? 'equipped' : '';
            html += `<div class="rod-item ${equipped}" onclick="equipRod('${rod.id}')">
                <span>üé£</span><span><b>${rod.name}</b> (x${rod.multiplier})</span>
                ${equipped ? '‚úÖ' : ''}
            </div>`;
        });
        div.innerHTML = html;
    }

    function renderBaitShop() {
        let shop = document.getElementById('baitShop');
        let html = '';
        CONFIG.baits.forEach(b => {
            let canAfford = gameState.coins >= b.price ? 'pointer' : 'not-allowed';
            html += `<div class="bait-item" onclick="buyBait('${b.id}')" style="cursor:${canAfford}">
                <span class="bait-icon">${b.emoji}</span>
                <span><b>${b.name}</b><br>${b.desc}<br><span style="color:#ffe066;">${b.price}ü™ô</span></span>
            </div>`;
        });
        shop.innerHTML = html;
    }

    function updateActiveBaits() {
        let div = document.getElementById('activeBaits');
        if (!gameState.activeBaits.length) { div.innerHTML = 'none'; return; }
        let now = Date.now();
        gameState.activeBaits = gameState.activeBaits.filter(b => (now - b.startTime) < b.duration * 60 * 1000);
        let html = '';
        gameState.activeBaits.forEach(b => {
            let left = Math.ceil((b.duration*60*1000 - (now - b.startTime))/60000);
            html += `<div>${b.emoji} ${b.name} (${left}min)</div>`;
        });
        div.innerHTML = html;
    }

    // ========== FISHING ==========
    window.catchFish = function() {
        // Button animation
        let btn = document.getElementById('fishButton');
        btn.style.transform = 'scale(0.85)';
        setTimeout(()=> btn.style.transform = 'scale(1)', 120);

        // Weighted random with bait
        let weights = CONFIG.rarities.map(r => ({ id: r.id, weight: r.weight }));
        gameState.activeBaits.forEach(bait => {
            let baitDef = CONFIG.baits.find(b => b.id === bait.id);
            if (baitDef) {
                Object.entries(baitDef.effect).forEach(([rar, mult]) => {
                    let idx = weights.findIndex(w => w.id === rar);
                    if (idx >= 0) weights[idx].weight *= mult;
                });
            }
        });
        let total = weights.reduce((a,b) => a + b.weight, 0);
        let rand = Math.random() * total;
        let chosenRarity = weights[0].id;
        for (let w of weights) {
            if (rand < w.weight) { chosenRarity = w.id; break; }
            rand -= w.weight;
        }

        // Get fish from current zone
        let zoneId = gameState.zone;
        let possible = fishDB.filter(f => f.zones.includes(zoneId) && f.rarity === chosenRarity);
        if (possible.length === 0) possible = fishDB.filter(f => f.rarity === chosenRarity);
        let fish = possible[Math.floor(Math.random() * possible.length)] || { name: 'Mystery Fish', emoji: 'üêü', rarity: 'common' };

        // Value calc
        let rod = CONFIG.rods.find(r => r.id === gameState.rod);
        let rodMult = rod ? rod.multiplier : 1;
        let rarityObj = CONFIG.rarities.find(r => r.id === fish.rarity);
        let value = Math.floor(rarityObj.baseValue * (1 + gameState.zone*0.2) * rodMult * (0.8 + Math.random()*0.5));
        gameState.coins += value;
        gameState.totalCatches++;
        gameState.pity = (fish.rarity === 'common') ? gameState.pity + 1 : 0;

        // Dex
        let fid = `${fish.rarity}_${fish.name}`;
        gameState.fishDex[fid] = (gameState.fishDex[fid] || 0) + 1;

        // Boss spawn (only if no boss pending or active)
        if (!gameState.pendingBoss && !gameState.currentBoss) {
            let bossChance = 0.01 + gameState.pity * 0.0005;
            if (Math.random() < bossChance) {
                let bossList = CONFIG.bosses;
                gameState.pendingBoss = bossList[Math.floor(Math.random() * bossList.length)];
                showBossEncounter();
            }
        }

        // Show catch
        let cd = document.getElementById('catchDisplay');
        cd.innerHTML = `
            <div class="caught-fish-emoji">${fish.emoji}</div>
            <div><b>${fish.name}</b> (${rarityObj.name})</div>
            <div>+${value} ü™ô</div>
        `;

        updateUI();
        saveGame();
    };

    // ========== BOSS ENCOUNTER SYSTEM ==========
    function showBossEncounter() {
        if (!gameState.pendingBoss) return;
        let boss = gameState.pendingBoss;
        document.getElementById('bossEmoji').innerText = boss.emoji;
        document.getElementById('bossName').innerText = boss.name;
        document.getElementById('bossDesc').innerText = `A wild ${boss.name} appears! HP: ${boss.hp} | Reward: ${boss.reward}ü™ô. Fight?`;
        document.getElementById('bossEncounter').style.display = 'flex';
    }

    window.acceptBoss = function() {
        if (!gameState.pendingBoss) return;
        gameState.currentBoss = gameState.pendingBoss;
        gameState.bossHP = gameState.currentBoss.hp;
        gameState.pendingBoss = null;
        document.getElementById('bossEncounter').style.display = 'none';
        updateUI();
    };

    window.declineBoss = function() {
        gameState.pendingBoss = null;
        document.getElementById('bossEncounter').style.display = 'none';
        // message
        document.getElementById('catchDisplay').innerHTML = '<div>You fled from the boss...</div>';
    };

    window.attackBoss = function() {
        if (!gameState.currentBoss) return;
        let dmg = 50 + gameState.zone * 20;
        gameState.bossHP -= dmg;
        if (gameState.bossHP <= 0) {
            gameState.coins += gameState.currentBoss.reward;
            gameState.currentBoss = null;
            document.getElementById('catchDisplay').innerHTML = '<div class="caught-fish-emoji">üèÜ</div><div>BOSS DEFEATED!</div>';
        }
        updateUI();
        saveGame();
    };

    // ========== CRATE WITH SPIN ANIMATION AND FODDER ==========
    window.openCrate = function() {
        if (gameState.coins < 500) return;
        gameState.coins -= 500;

        let cd = document.getElementById('catchDisplay');
        cd.innerHTML = '<div class="caught-fish-emoji crate-spin">üì¶</div><div>Spinning...</div>';

        setTimeout(() => {
            let r = Math.random();
            let reward;
            if (r < 0.4) { // fodder (40%)
                let fodder = CONFIG.crateFodder[Math.floor(Math.random() * CONFIG.crateFodder.length)];
                reward = { type: 'fodder', name: fodder };
                cd.innerHTML = `<div class="caught-fish-emoji">üóëÔ∏è</div><div>You got: ${fodder} (worthless)</div>`;
            } else if (r < 0.65) { // coins (25%)
                let amount = 200 + Math.floor(Math.random() * 800);
                gameState.coins += amount;
                cd.innerHTML = `<div class="caught-fish-emoji">ü™ô</div><div>Crate gave ${amount} coins!</div>`;
            } else if (r < 0.85) { // bait (20%)
                let bait = CONFIG.baits[Math.floor(Math.random() * CONFIG.baits.length)];
                gameState.activeBaits.push({
                    id: bait.id, name: bait.name, emoji: bait.emoji,
                    effect: bait.effect, duration: bait.duration, startTime: Date.now()
                });
                cd.innerHTML = `<div class="caught-fish-emoji">${bait.emoji}</div><div>You got ${bait.name}!</div>`;
            } else { // rare rod (15%)
                let rareRods = CONFIG.rods.filter(r => r.crateOnly && !gameState.ownedRods.includes(r.id));
                if (rareRods.length > 0) {
                    let rod = rareRods[Math.floor(Math.random() * rareRods.length)];
                    gameState.ownedRods.push(rod.id);
                    cd.innerHTML = `<div class="caught-fish-emoji">üé£</div><div>NEW ROD: ${rod.name}!</div>`;
                } else {
                    gameState.coins += 1000;
                    cd.innerHTML = `<div class="caught-fish-emoji">ü™ô</div><div>Duplicate rod: 1000 coins!</div>`;
                }
            }
            updateUI();
            saveGame();
        }, 600);
    };

    // ========== OTHER FUNCTIONS ==========
    window.nextZone = function() {
        if (gameState.zone < CONFIG.zones.length - 1) {
            gameState.zone++;
            updateUI(); saveGame();
        }
    };

    window.buyBait = function(baitId) {
        let bait = CONFIG.baits.find(b => b.id === baitId);
        if (!bait || gameState.coins < bait.price) return;
        gameState.coins -= bait.price;
        gameState.activeBaits.push({
            id: bait.id, name: bait.name, emoji: bait.emoji,
            effect: bait.effect, duration: bait.duration, startTime: Date.now()
        });
        updateUI(); saveGame();
    };

    // ========== KEYBINDING (L) ==========
    document.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'l') {
            catchFish();
        }
    });

    // ========== SAVE/LOAD ==========
    function saveGame() { localStorage.setItem('fishingRods', JSON.stringify(gameState)); }
    function loadGame() {
        let saved = localStorage.getItem('fishingRods');
        if (saved) Object.assign(gameState, JSON.parse(saved));
    }

    // ========== INIT ==========
    loadGame();
    updateUI();
    setInterval(updateActiveBaits, 10000);
})();
</script>
</body>
</html>
